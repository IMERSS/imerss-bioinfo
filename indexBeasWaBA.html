<!DOCTYPE html>
<html lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <title>BBEA TTOOL WaBA</title>

        <link rel="stylesheet" href="node_modules/infusion/src/lib/jquery/ui/css/default-theme/core.css" />
        <link rel="stylesheet" href="node_modules/infusion/src/lib/jquery/ui/css/default-theme/tooltip.css" />
        <link rel="stylesheet" href="node_modules/infusion/src/lib/jquery/ui/css/default-theme/theme.css" />
        <link rel="stylesheet" href="node_modules/jquery-ui/themes/base/tabs.css" />
        <link rel="stylesheet" type="text/css" href="node_modules/infusion/src/framework/core/css/fluid.css" />
        <link rel="stylesheet" type="text/css" href="node_modules/accessible-autocomplete/dist/accessible-autocomplete.min.css" />
        <link rel="stylesheet" type="text/css" href="node_modules/@stanko/dual-range-input/dist/index.css" />
        <link rel="stylesheet" href="https://cdn.materialdesignicons.com/2.0.46/css/materialdesignicons.min.css">
        <!-- Refers to some fonts so just use the CDN -
          <link rel="stylesheet" href="node_modules/@mdi/font/css/materialdesignicons.min.css"> -->
        <link rel="stylesheet" href="node_modules/pretty-checkbox/dist/pretty-checkbox.min.css">

        <script src="node_modules/infusion/src/lib/jquery/core/js/jquery.js"></script>
        <script src="node_modules/infusion/src/lib/jquery/ui/js/version.js"></script>
        <script src="node_modules/infusion/src/lib/jquery/ui/js/keycode.js"></script>
        <script src="node_modules/infusion/src/lib/jquery/ui/js/safe-active-element.js"></script>
        <script src="node_modules/jquery-ui/ui/widget.js"></script>
        <script src="node_modules/jquery-ui/ui/unique-id.js"></script>
        <script src="node_modules/jquery-ui/ui/position.js"></script>
        <script src="node_modules/jquery-ui/ui/widgets/tabs.js"></script>
        <script src="node_modules/jquery-ui/ui/widgets/tooltip.js"></script>

        <script src="node_modules/infusion/src/framework/core/js/jquery.keyboard-a11y.js"></script>
        <script src="node_modules/infusion/src/framework/core/js/Fluid.js"></script>
        <script src="node_modules/infusion/src/framework/core/js/FluidPromises.js"></script>
        <script src="node_modules/infusion/src/framework/core/js/FluidDebugging.js"></script>
        <script src="node_modules/infusion/src/framework/core/js/FluidDocument.js"></script>
        <script src="node_modules/infusion/src/framework/core/js/FluidIoC.js"></script>
        <script src="node_modules/infusion/src/framework/core/js/DataBinding.js"></script>
        <script src="node_modules/infusion/src/framework/core/js/ModelTransformation.js"></script>
        <script src="node_modules/infusion/src/framework/core/js/ModelTransformationTransforms.js"></script>
        <script src="node_modules/infusion/src/framework/enhancement/js/ContextAwareness.js"></script>
        <script src="node_modules/infusion/src/framework/enhancement/js/ProgressiveEnhancement.js"></script>
        <script src="node_modules/infusion/src/framework/core/js/FluidView.js"></script>
        <script src="node_modules/infusion/src/framework/core/js/FluidView-browser.js"></script>
        <script src="node_modules/infusion/src/framework/core/js/NewViewSupport.js"></script>
        <script src="node_modules/infusion/src/framework/core/js/DataSource.js"></script>
        <script src="node_modules/infusion/src/framework/core/js/ResourceLoader.js"></script>
        <script src="node_modules/infusion/src/framework/core/js/ResourceLoader-browser.js"></script>
        <script src="node_modules/infusion/src/framework/renderer/js/fluidParser.js"></script>

        <script src="node_modules/infusion/src/components/tooltip/js/Tooltip.js"></script>

        <script src="node_modules/accessible-autocomplete/dist/accessible-autocomplete.min.js"></script>

        <script src="node_modules/maplibre-gl/dist/maplibre-gl-dev.js"></script>
        <script src="node_modules/@mapbox/mapbox-gl-draw/dist/mapbox-gl-draw-unminified.js"></script>
        <script src="node_modules/d3/dist/d3.js"></script>

        <script src="src/lib/signals-core.min.js"></script>
        <script src="src/lib/vizjs.js"></script>
        <script src="src/lib/point-in-polygon.js"></script>
        <script src="src/geom/geoJSON.js"></script>

        <script src="https://unpkg.com/pako@2.1.0/dist/pako_inflate.min.js"></script>
        <script src="https://unpkg.com/papaparse@5.4.1/papaparse.min.js"></script>

        <link rel="stylesheet" type="text/css" href="src/client/css/imerss-core.css"/>
        <link rel="stylesheet" type="text/css" href="src/client/css/maplibre-gl.css"/>
        <link rel="stylesheet" type="text/css" href="src/client/css/mapbox-gl-draw.css"/>
        <link rel="stylesheet" type="text/css" href="src/client/css/imerss-bbea.css"/>

        <script src="src/utils/utils.js"></script>
        <script src="src/client/js/colour.js"></script>
        <script src="src/client/js/renderSVG.js"></script>
        <script src="src/client/js/new/fluidNew.js"></script>
        <script src="src/client/js/new/imerss-new.js"></script>
        <script src="src/client/js/new/polygon-draw.js"></script>
        <script src="src/client/js/new/filters.js"></script>
        <script src="src/client/js/new/imerss-bbea.js"></script>
        <script src="src/client/js/new/bipartitePP.js"></script>
        <script src="src/client/js/autocomplete.js"></script>
        <script src="src/client/js/tabs.js"></script>
        <script src="src/client/js/new/newChecklist.js"></script>
        <script src="src/client/js/new/dual-range-input.js"></script>

        <svg id="inline-svg">
            <defs>
                <symbol id="filter-reset" viewBox="0 0 32 32">
                    <path d="M22.5,9A7.4522,7.4522,0,0,0,16,12.792V8H14v8h8V14H17.6167A5.4941,5.4941,0,1,1,22.5,22H22v2h.5a7.5,7.5,0,0,0,0-15Z"/>
                    <path d="M26,6H4V9.171l7.4142,7.4143L12,17.171V26h4V24h2v2a2,2,0,0,1-2,2H12a2,2,0,0,1-2-2V18L2.5858,10.5853A2,2,0,0,1,2,9.171V6A2,2,0,0,1,4,4H26Z"/>
                </symbol>
                <symbol id="copy-clipboard" viewBox="0 0 32 32">
                    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
                </symbol>
                <symbol id="copy-check" viewBox="0 0 32 32">
                    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
                </symbol>
                <symbol id="x-circle-close" viewBox="0 0 24 24">
                    <path d="M16 8L12 12M12 12L8 16M12 12L8 8M12 12L16 16" stroke="#808080" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <circle cx="12" cy="12" r="10" fill="none" stroke="#808080" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </symbol>
                <symbol id="fullscreen" viewBox="0 0 24 24">
                    <path d="M9 4H4L4 9M20 9V4L15 4M15 20H20L20 15M4 15L4 20L9.00002 20" fill="none" stroke="#000000" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                </symbol>
                <symbol id="fullscreen-exit" viewBox="0 0 32 32" stroke-width="2" fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M4 12 L12 12 12 4 M20 4 L20 12 28 12 M4 20 L12 20 12 28 M28 20 L20 20 20 28" />
                </symbol>
            </defs>
        </svg>
    </head>

    <body>
        <h2>BBEA TTOOL</h2>
        <div class="imerss-container">
            <div class="bee-loading-container">
                <div class="loading-message">Bee Plant Network Visualization Tool Loading</div>
                <div class="bee">
                    <div class="bee-body">
                        <div class="line"></div>
                    </div>
                    <div>
                        <div class="wing-right"></div>
                        <div class="wing-left"></div>
                    </div>
                    <div class="bee-path">
                        <div class="pollen"></div>
                        <div class="pollen"></div>
                        <div class="pollen"></div>
                        <div class="pollen"></div>
                        <div class="pollen"></div>
                        <div class="pollen"></div>
                        <div class="pollen"></div>
                        <div class="pollen"></div>
                        <div class="pollen"></div>
                        <div class="pollen"></div>
                        <div class="pollen"></div>
                        <div class="pollen"></div>
                    </div>
                </div>
            </div>

            <div class="imerss-map-and-taxa">

                <div class="imerss-map-holder imerss-nodismiss-map">
                    <div class="imerss-map">
                    </div>
                    <div class="imerss-mobile-warning">
                        This visualisation is best viewed on a desktop browser. Whilst basic mapping and filtering is available in this view,
                        displaying the plant-pollinator interaction network requires more space than is available on a mobile device.
                    </div>
                </div>
                <div class="imerss-filter-panel" f-id="filter-panel">
                    <div class="imerss-filters imerss-main-filters">
                    </div>
                    <div class="imerss-filter-controls">
                        <svg width="24" height="24" class="imerss-reset-filter imerss-basic-tooltip" title="Reset all filters">
                            <use href="#filter-reset" />
                        </svg>
                        <div>Reset filters</div>
                    </div>
                    <div class="imerss-record-reporter">
                    </div>
                </div>

                <div class="imerss-info-panel imerss-nodismiss-map">
                    <div class="imerss-collector-report imerss-hidden">
                        <div>A volunteer report is available:</div><a href="#"></a>
                    </div>
                    <div class="imerss-taxonDisplay">
                        <div class="taxonDisplay-row"></div>
                    </div>
                </div>
                <div class="imerss-controls imerss-nodismiss-map">
                    <div class="imerss-fullscreen">
                        <svg width="24" height="24" class="imerss-fullscreen-control imerss-basic-tooltip" title="Open in full-screen mode">
                            <use href="#fullscreen" />
                        </svg>
                        <svg width="24" height="24" class="imerss-fullscreen-exit-control imerss-basic-tooltip" title="Exit full-screen mode">
                            <use href="#fullscreen-exit" />
                        </svg>
                    </div>
                </div>

            </div>
            <div class="imerss-checklists">
                <div class="imerss-pollinators imerss-checklist-holder">
                    <div class="imerss-panel-label"><span>Bees</span><span class="imerss-copy-checklist"><svg width="32" height="32" >
                            <use href="#copy-clipboard" />
                        </svg></span>
                    </div>
                    <div class="imerss-bbea-filters">
                    </div>
                    <div class="imerss-checklist">
                    </div>
                </div>
                <div class="imerss-interactions">
                    <div class="imerss-panel-label">Interactions</div>

                    <div class="imerss-tabs ui-tabs ui-widget ui-widget-content">
                        <ul class="ui-tabs-nav" role="tablist">
                            <li class="ui-tabs-tab ui-tab ui-state-default ui-tabs-active">
                                <a class="ui-tabs-anchor" href="#fli-tab-bipartite">Bipartite View</a>
                            </li>
                            <li class="ui-tabs-tab ui-tab ui-state-default">
                                <a class="ui-tabs-anchor" href="#fli-tab-matrix">Matrix View</a>
                            </li>
                        </ul>
                        <div id="fli-tab-bipartite" class="imerss-tab-panel">
                            <div class="imerss-bipartite">
                                <svg width="32" height="2048">
                                </svg>
                            </div>
                        </div>
                        <div id="fli-tab-matrix" class="imerss-tab-panel">
                            <div class="imerss-interactions-holder">
                            </div>
                        </div>
                    </div>
                </div>
                <div class="imerss-plants imerss-checklist-holder">
                    <div class="imerss-panel-label"><span>Plants</span><span class="imerss-copy-checklist"><svg width="32" height="32" >
                            <use href="#copy-clipboard" />
                        </svg></span>
                    </div>
                    <div class="imerss-checklist">
                    </div>
                </div>
            </div>

        </div>
        <script>
            hortis.vizLoaderWithMap(".imerss-container", {
                gradeNames: "hortis.beaVizLoader",
                obsFile: "data/b-team/plant-pollinators-WaBA-2025-labels.csv",
                taxaFile: "data/b-team/plant-pollinators-WaBA-2025-assigned-taxa.csv",
                regionIndirectionFile: "data/b-team/plant-pollinators-WaBA-2025-regionIndirection.csv",
                resourceBase: "src/client"
            });
        </script>
    </body>
</html>
